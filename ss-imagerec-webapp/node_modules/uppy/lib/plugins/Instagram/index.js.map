{"version":3,"sources":["../../../src/plugins/Instagram/index.js"],"names":["Plugin","require","Provider","View","h","module","exports","uppy","opts","type","id","title","icon","host","provider","authProvider","files","onAuth","bind","render","defaultOptions","install","view","viewType","setPluginState","authenticated","folders","directories","activeRow","filterInput","isSearchVisible","target","mount","uninstall","tearDown","unmount","getFolder","isFolder","item","getItemData","getItemIcon","images","thumbnail","url","getItemSubList","subItems","data","forEach","subItem","carousel_media","i","index","created_time","newSubItem","carousel_id","push","getItemName","getMimeType","getItemId","getItemRequestPath","suffix","isNaN","getItemModifiedDate","getItemThumbnailUrl","getNextPagePath","getPluginState","length","state"],"mappings":"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","file":"index.js","sourcesContent":["const Plugin = require('../../core/Plugin')\nconst Provider = require('../Provider')\nconst View = require('../Provider/view')\nconst { h } = require('preact')\n\nmodule.exports = class Instagram extends Plugin {\n  constructor (uppy, opts) {\n    super(uppy, opts)\n    this.type = 'acquirer'\n    this.id = this.opts.id || 'Instagram'\n    this.title = 'Instagram'\n    this.icon = () => (\n      <svg aria-hidden=\"true\" class=\"UppyIcon UppyModalTab-icon\" width=\"28\" height=\"28\" viewBox=\"0 0 512 512\">\n        <path d=\"M256,49.471c67.266,0,75.233.257,101.8,1.469,24.562,1.121,37.9,5.224,46.778,8.674a78.052,78.052,0,0,1,28.966,18.845,78.052,78.052,0,0,1,18.845,28.966c3.45,8.877,7.554,22.216,8.674,46.778,1.212,26.565,1.469,34.532,1.469,101.8s-0.257,75.233-1.469,101.8c-1.121,24.562-5.225,37.9-8.674,46.778a83.427,83.427,0,0,1-47.811,47.811c-8.877,3.45-22.216,7.554-46.778,8.674-26.56,1.212-34.527,1.469-101.8,1.469s-75.237-.257-101.8-1.469c-24.562-1.121-37.9-5.225-46.778-8.674a78.051,78.051,0,0,1-28.966-18.845,78.053,78.053,0,0,1-18.845-28.966c-3.45-8.877-7.554-22.216-8.674-46.778-1.212-26.564-1.469-34.532-1.469-101.8s0.257-75.233,1.469-101.8c1.121-24.562,5.224-37.9,8.674-46.778A78.052,78.052,0,0,1,78.458,78.458a78.053,78.053,0,0,1,28.966-18.845c8.877-3.45,22.216-7.554,46.778-8.674,26.565-1.212,34.532-1.469,101.8-1.469m0-45.391c-68.418,0-77,.29-103.866,1.516-26.815,1.224-45.127,5.482-61.151,11.71a123.488,123.488,0,0,0-44.62,29.057A123.488,123.488,0,0,0,17.3,90.982C11.077,107.007,6.819,125.319,5.6,152.134,4.369,179,4.079,187.582,4.079,256S4.369,333,5.6,359.866c1.224,26.815,5.482,45.127,11.71,61.151a123.489,123.489,0,0,0,29.057,44.62,123.486,123.486,0,0,0,44.62,29.057c16.025,6.228,34.337,10.486,61.151,11.71,26.87,1.226,35.449,1.516,103.866,1.516s77-.29,103.866-1.516c26.815-1.224,45.127-5.482,61.151-11.71a128.817,128.817,0,0,0,73.677-73.677c6.228-16.025,10.486-34.337,11.71-61.151,1.226-26.87,1.516-35.449,1.516-103.866s-0.29-77-1.516-103.866c-1.224-26.815-5.482-45.127-11.71-61.151a123.486,123.486,0,0,0-29.057-44.62A123.487,123.487,0,0,0,421.018,17.3C404.993,11.077,386.681,6.819,359.866,5.6,333,4.369,324.418,4.079,256,4.079h0Z\" />\n        <path d=\"M256,126.635A129.365,129.365,0,1,0,385.365,256,129.365,129.365,0,0,0,256,126.635Zm0,213.338A83.973,83.973,0,1,1,339.974,256,83.974,83.974,0,0,1,256,339.973Z\" />\n        <circle cx=\"390.476\" cy=\"121.524\" r=\"30.23\" />\n      </svg>\n    )\n\n    this[this.id] = new Provider(uppy, {\n      host: this.opts.host,\n      provider: 'instagram',\n      authProvider: 'instagram'\n    })\n\n    this.files = []\n\n    this.onAuth = this.onAuth.bind(this)\n    this.render = this.render.bind(this)\n\n    // set default options\n    const defaultOptions = {}\n\n    // merge default options with the ones set by user\n    this.opts = Object.assign({}, defaultOptions, opts)\n  }\n\n  install () {\n    this.view = new View(this, {\n      viewType: 'grid'\n    })\n    // Set default state for Instagram\n    this.setPluginState({\n      authenticated: false,\n      files: [],\n      folders: [],\n      directories: [],\n      activeRow: -1,\n      filterInput: '',\n      isSearchVisible: false\n    })\n\n    const target = this.opts.target\n    if (target) {\n      this.mount(target, this)\n    }\n  }\n\n  uninstall () {\n    this.view.tearDown()\n    this.unmount()\n  }\n\n  onAuth (authenticated) {\n    this.setPluginState({ authenticated })\n    if (authenticated) {\n      this.view.getFolder('recent')\n    }\n  }\n\n  isFolder (item) {\n    return false\n  }\n\n  getItemData (item) {\n    return item\n  }\n\n  getItemIcon (item) {\n    return <img src={item.images.thumbnail.url} />\n  }\n\n  getItemSubList (item) {\n    const subItems = []\n    item.data.forEach((subItem) => {\n      if (subItem.carousel_media) {\n        subItem.carousel_media.forEach((i, index) => {\n          const { id, created_time } = subItem\n          const newSubItem = Object.assign({}, i, { id, created_time })\n          newSubItem.carousel_id = index\n          subItems.push(newSubItem)\n        })\n      } else {\n        subItems.push(subItem)\n      }\n    })\n    return subItems\n  }\n\n  getItemName (item) {\n    return ''\n  }\n\n  getMimeType (item) {\n    return item.type === 'video' ? 'video/mp4' : 'image/jpeg'\n  }\n\n  getItemId (item) {\n    return `${item.id}${item.carousel_id || ''}`\n  }\n\n  getItemRequestPath (item) {\n    const suffix = isNaN(item.carousel_id) ? '' : `?carousel_id=${item.carousel_id}`\n    return `${item.id}${suffix}`\n  }\n\n  getItemModifiedDate (item) {\n    return item.created_time\n  }\n\n  getItemThumbnailUrl (item) {\n    return item.images.thumbnail.url\n  }\n\n  getNextPagePath () {\n    const { files } = this.getPluginState()\n    return `recent?max_id=${this.getItemId(files[files.length - 1])}`\n  }\n\n  render (state) {\n    return this.view.render(state)\n  }\n}\n"]}